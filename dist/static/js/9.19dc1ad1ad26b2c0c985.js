webpackJsonp([9],{VOkb:function(t,e){},tpMp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("W6KN"),a=i("THWC"),n={name:"hOption",props:{value:{type:[String,Number],required:!0}}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("li",{staticClass:"h-selector-option"},[this._t("default",[this._v(this._s(this.value))])],2)},staticRenderFns:[]},r=i("C7Lr")(n,o,!1,null,null,null).exports,c=i("aA9S"),h=i.n(c),d={name:"hSelector",props:{value:{type:Object,required:!0},showValue:{type:String},title:{type:String,default:""}},data:function(){return{oldValue:h()({},this.value),show:!1}},computed:{defaultShowValue:function(){var t=[];for(var e in this.value)t.push(e+":"+this.value[e]);return t.join("/")}},mounted:function(){this.$on("changeSelected",this.changeSelected)},methods:{changeSelected:function(t,e){var i={};i[t]=e;var s=h()({},this.value,i);this.$emit("input",s)},cancel:function(){this.$emit("input",this.oldValue),this.show=!1},confirm:function(){this.oldValue=h()({},this.value),this.$emit("change",this.value),this.show=!1},showAddress:function(){this.show=!0}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"h-selector"},[i("div",{staticClass:"h-selector-show",on:{click:t.showAddress}},[t._v(t._s(t.showValue||t.defaultShowValue))]),t._v(" "),i("transition",{attrs:{name:"h-selector-move"}},[t.show?i("div",{staticClass:"h-selector-container"},[i("div",{staticClass:"h-selector-header"},[i("div",{staticClass:"h-selector-header-cancel",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"h-selector-header-title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{staticClass:"h-selector-header-confirm",on:{click:t.confirm}},[t._v("确定")])]),t._v(" "),i("div",{staticClass:"h-selector-content"},[t._t("default"),t._v(" "),i("div",{staticClass:"h-selector-bg"})],2)]):t._e()]),t._v(" "),i("transition",{attrs:{name:"h-selector-fade"}},[t.show?i("div",{staticClass:"h-selector-layer",on:{click:t.cancel}}):t._e()])],1)},staticRenderFns:[]},p=i("C7Lr")(d,l,!1,null,null,null).exports,u={name:"hWrapper",props:{prop:{type:String,required:!0}},data:function(){return{style:{transform:"translate3d(0px,0px,0px)",transition:"transform .3s"},activeIndex:0,startY:0,startTime:0,endY:0,endTime:0,prevY:0,direction:0,maxY:0,minY:0,optionHeight:0,parentHeight:0,optionLength:0}},computed:{propValue:function(){return this.$parent.value[this.prop]}},watch:{activeIndex:function(t){this.$children[t]&&this.$parent.$emit("changeSelected",this.prop,this.$children[t].value)},propValue:function(t){this.$emit("change",t),this.formatAddress()}},mounted:function(){var t=this;this.$nextTick(function(){t.formatData(),t.formatAddress()}),window.addEventListener("resize",function(){t.formatData(),t.formatAddress()})},updated:function(){var t=this;this.$nextTick(function(){t.formatData(),t.formatAddress()})},methods:{formatData:function(){var t=this.$children;this.optionLength=t.length,this.optionHeight=this.$refs.wrapper.children[0].offsetHeight,this.parentHeight=5*this.optionHeight,this.maxY=-this.optionHeight*(this.optionLength-1)},formatAddress:function(){var t=this,e=this.$children.findIndex(function(e){return e.value===t.$parent.value[t.prop]});this.activeIndex=e>-1?e:-1,this.style.transform="translate3d(0px,"+-this.activeIndex*this.optionHeight+"px,0px)"},touchStart:function(t){this.startY=t.touches[0].pageY,this.startTime=t.timeStamp,this.style.transition="none"},touchMove:function(t){var e=t.changedTouches[0].pageY;this.direction=e-this.startY,this.style.transform="translate3d(0px,"+(this.prevY+this.direction)+"px,0px)"},touchEnd:function(t){this.style.transition="transform .4s",this.endY=t.changedTouches[0].pageY,this.endTime=t.timeStamp,this.prevY=1*this.style.transform.split(",")[1].slice(0,-2);var e=-Math.round(this.prevY/this.optionHeight),i=Math.abs(this.endY-this.startY),s=this.endTime-this.startTime;this.direction>0?e=this.activeIndex-2*Math.round(i/s):this.direction<0&&(e=this.activeIndex+2*Math.round(i/s)),i<=1&&(e=Math.round((t.path[0].offsetTop-2*this.optionHeight)/this.optionHeight)),e=e<0?0:e>this.optionLength-1?this.optionLength-1:e,this.activeIndex=e,this.style.transform="translate3d(0px,"+-this.activeIndex*this.optionHeight+"px,0px)"},transitionEnd:function(){this.prevY=-this.activeIndex*this.optionHeight}}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"h-selector-wrapper",style:{height:t.parentHeight+"px"}},[i("ul",{ref:"wrapper",style:t.style,on:{touchstart:function(e){return t.touchStart(e)},touchmove:function(e){return t.touchMove(e)},touchend:function(e){return t.touchEnd(e)},transitionend:function(e){return t.transitionEnd(e)}}},[i("li",{staticClass:"h-selector-option"}),t._v(" "),i("li",{staticClass:"h-selector-option"},[t._v("请选择")]),t._v(" "),t._t("default"),t._v(" "),i("li",{staticClass:"h-selector-option"}),t._v(" "),i("li",{staticClass:"h-selector-option"})],2)])},staticRenderFns:[]},f=i("C7Lr")(u,v,!1,null,null,null).exports,g=i("TVG1"),m=i("gyMJ"),_={data:function(){return{isEdit:!1,captcha:"获取验证码",isWait:!1,count:g.a.get("captcha"),contacter:"",gender:1,phone:"",code:"",city_id:"",region_id:"",province_id:"",hospital_id:"",hospital_name:"",address:{province:"",city:"",region:""},regionList:[]}},components:{XRadio:s.a,XRadioGroup:a.a,vDistpicker:vDistpicker,HSelector:p,HOption:r,HWrapper:f},activated:function(){""!=this.$store.state.hospitalID&&(this.hospital_id=this.$store.state.hospitalID,this.$store.dispatch("setHospitalId",""),this.getHospitalName(this.hospital_id))},created:function(){this.getAddressTree2(),this.getOrderlies(),this.dealCaptcha()},computed:{showAddress:function(){var t=this;return""+(this.regionList.find(function(e){return e.id===t.address.region})||{name:"选择区"}).name}},watch:{count:function(){this.count>0?(this.captcha=this.count+"秒后重发",this.isWait=!0):(this.isWait=!1,this.captcha="获取验证码")},address:function(){this.region_id=this.address.region}},beforeDestroy:function(){this.resend&&clearInterval(this.resend)},methods:{goToHospital:function(){this.$router.push({name:"hospital",query:{id:this.$route.query.id}})},selected:function(t){this.popupVisible=!1,this.agentArea=t.province.value+t.city.value+t.area.value},addOrderlies:function(){var t=this;Object(m.a)("/hapi/pet/addOrderlies",{pet_id:this.$route.query.id,contacter:this.contacter,gender:this.gender,phone:this.phone,code:this.code,city_id:"1964",region_id:this.region_id,hospital_id:this.hospital_id}).then(function(e){e&&(t.$message.success("监护人添加成功"),t.$router.push({name:"confirmOrder",query:{id:t.$route.query.id}}))})},editOrderlies:function(){var t=this;Object(m.a)("/hapi/pet/orderliesSave",{pet_id:this.$route.query.id,contacter:this.contacter,gender:this.gender,phone:this.phone,code:this.code,city_id:"1964",region_id:this.region_id,hospital_id:this.hospital_id}).then(function(e){e&&(t.$message.success("监护人添加成功"),t.$router.push({name:"confirmOrder",query:{id:t.$route.query.id}}))})},getOrderlies:function(){var t=this;Object(m.c)("api",{s:"/hapi/pet/orderliesDetail",pet_id:this.$route.query.id}).then(function(e){e&&(t.isEdit=!0,t.contacter=e.contacter,t.gender=e.gender,t.phone=e.phone,t.address.region=e.region_id,t.hospital_id=e.hospital_id)})},getHospitalName:function(t){var e=this;console.log(t),Object(m.c)("api",{s:"/hapi/hospital/detail",hospital_id:t}).then(function(t){t&&(e.hospital_name=t.name)})},getAddressTree2:function(){var t=this;Object(m.c)("api",{s:"/hapi/Region/getAddressTree",pid:1965,level:3}).then(function(e){e&&(t.regionList=e)})},getLoginCode:function(){var t=this;Object(m.c)("api",{s:"/hapi/Sms/getLoginCode",phone:this.phone}).then(function(e){t.$Notification.success("验证码发送成功"),t.getCaptcha()})},getCaptcha:function(){if(g.a.get("Gcaptcha"))return!1;this.count=60;var t=this;this.resend=setInterval(function(){t.count--,t.count>0?g.a.set("Gcaptcha",1e3*t.count,1e3*t.count):clearInterval(t.resend)},1e3)},dealCaptcha:function(){if(g.a.get("Gcaptcha")){var t=this;this.count=parseInt(g.a.get("Gcaptcha")/1e3),this.resend=setInterval(function(){t.count--,t.count>0?g.a.set("Gcaptcha",1e3*t.count,1e3*t.count):clearInterval(t.resend)},1e3)}}}},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("keep-alive",[i("div",[i("div",{staticClass:"public-view"},[i("div",{staticClass:"info"},[i("div",{staticClass:"content1"},[i("div",{staticClass:"left"},[t._v("联系人")]),t._v(" "),i("div",{staticClass:"right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.contacter,expression:"contacter"}],attrs:{type:"text",placeholder:"请输入真实姓名"},domProps:{value:t.contacter},on:{input:function(e){e.target.composing||(t.contacter=e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"content1"},[i("div",{staticClass:"left"},[t._v("性别")]),t._v(" "),i("div",{staticClass:"right"},[i("XRadioGroup",{staticClass:"radioGroup",model:{value:t.gender,callback:function(e){t.gender=e},expression:"gender"}},[i("XRadio",{attrs:{name:"male",value:"1",label:"男"}}),t._v(" "),i("XRadio",{attrs:{name:"female",value:"2",label:"女"}})],1)],1)]),t._v(" "),i("div",{staticClass:"content1"},[i("div",{staticClass:"left"},[t._v("手机")]),t._v(" "),i("div",{staticClass:"right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"content1"},[i("div",{staticClass:"left"},[t._v("验证码")]),t._v(" "),i("div",{staticClass:"right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"verificationCode",attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}}),t._v(" "),i("span",{staticClass:"captchaStyle",class:{wait:t.isWait},on:{click:function(e){return t.getLoginCode()}}},[t._v(t._s(t.captcha))])])]),t._v(" "),i("div",{staticClass:"content1"},[i("div",{staticClass:"left"},[t._v("地区")]),t._v(" "),i("div",{staticClass:"right"},[i("h-selector",{attrs:{showValue:t.showAddress},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}},[i("h-wrapper",{attrs:{prop:"region"}},t._l(t.regionList,function(e){return i("h-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),i("img",{staticClass:"rectangle",attrs:{src:"static/images/Rectangle-path@2x.png",alt:""}})],1)]),t._v(" "),i("div",{staticClass:"content1"},[i("div",{staticClass:"left"},[t._v("医院")]),t._v(" "),i("div",{staticClass:"right"},[""==t.hospital_id?i("span",{staticClass:"tips",on:{click:t.goToHospital}},[t._v("请选择愿意前往的医院")]):t._e(),t._v(" "),""!=t.hospital_id?i("span",{staticClass:"tips choose"},[t._v(t._s(t.hospital_name))]):t._e(),t._v(" "),i("img",{staticClass:"rectangle",attrs:{src:"static/images/Rectangle-path@2x.png",alt:""},on:{click:function(t){}},model:{value:t.region_id,callback:function(e){t.region_id=e},expression:"region_id"}})])])]),t._v(" "),i("div",{staticClass:"seizeSeat"}),t._v(" "),t.isEdit?i("div",{staticClass:"next",on:{click:t.editOrderlies}},[t._v("修改")]):i("div",{staticClass:"next",on:{click:t.addOrderlies}},[t._v("下一步")])])])])},staticRenderFns:[]};var x=i("C7Lr")(_,C,!1,function(t){i("VOkb")},"data-v-98a3b96e",null);e.default=x.exports}});