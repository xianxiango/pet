webpackJsonp([3],{a3Yh:function(t,e,n){"use strict";e.__esModule=!0;var s,i=n("liLe"),a=(s=i)&&s.__esModule?s:{default:s};e.default=function(t,e,n){return e in t?(0,a.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},lbsL:function(t,e,n){n("ngi5");var s=n("Rv9F").Object;t.exports=function(t,e,n){return s.defineProperty(t,e,n)}},liLe:function(t,e,n){t.exports={default:n("lbsL"),__esModule:!0}},ngi5:function(t,e,n){var s=n("8leu");s(s.S+s.F*!n("berT"),"Object",{defineProperty:n("Mr+r").f})},"ook+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,i=n("a3Yh"),a=n.n(i),o=n("TVG1"),c=n("gyMJ"),r=(s={data:function(){return{captcha:"获取验证码",isWait:!1,count:o.a.get("captcha"),phone:"",code:"",appid:""}},methods:{wxLogin:function(){var t=this;Object(c.c)("api",{s:"/hapi/Weixin/getAppid"}).then(function(e){e&&(t.appid=e.appid,window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.appid+"&redirect_uri=http://m.cyongpet.com/wxLogin&response_type=code&scope=snsapi_userinfo&state=123#wechat_redirect")})},wxCode:function(){var t=this;Object(c.c)("api",{s:"/hapi/Weixin/wxLogin",code:this.$route.query.code,state:this.$route.query.state}).then(function(e){if(e){t.$message.success("登录成功");var n=e;o.a.set("token",n.token,2592e6),o.a.set("user_id",n.user_id,2592e6),t.$store.commit("SET_TOKEN",n.token),t.$store.commit("SET_USER_ID",n.user_id),t.$store.state.token?t.$router.push("/"):t.$router.replace("/login")}})},login:function(){var t=this;Object(c.a)("/hapi/User/login",{phone:this.phone,code:this.code}).then(function(e){if(e){t.$message.success("登录成功");var n=e;o.a.set("token",n.token,2592e6),o.a.set("user_id",n.user_id,2592e6),o.a.set("hasPhone",1,2592e6),t.$store.commit("SET_TOKEN",n.token),t.$store.commit("SET_USER_ID",n.user_id),t.$store.commit("SET_HAS_PHONE",1),t.$store.state.token?t.$router.push("/"):t.$router.replace("/login")}})},getLoginCode:function(){var t=this;Object(c.c)("api",{s:"/hapi/Sms/getLoginCode",phone:this.phone}).then(function(e){e&&(t.$Notification.success("验证码发送成功"),t.getCaptcha())})},getCaptcha:function(){if(o.a.get("captcha"))return!1;this.count=60;var t=this;this.resend=setInterval(function(){t.count--,t.count>0?o.a.set("captcha",1e3*t.count,1e3*t.count):clearInterval(t.resend)},1e3)},dealCaptcha:function(){if(o.a.get("captcha")){var t=this;this.count=parseInt(o.a.get("captcha")/1e3),this.resend=setInterval(function(){t.count--,t.count>0?o.a.set("captcha",1e3*t.count,1e3*t.count):clearInterval(t.resend)},1e3)}}},beforeCreate:function(){document.getElementsByTagName("body")[0].className="add_bg"},beforeMount:function(){document.getElementsByTagName("body")[0].className="add_bg"},beforeDestroy:function(){document.body.removeAttribute("class")},destroy:function(){document.body.removeAttribute("class")},mounted:function(){document.getElementsByTagName("body")[0].className="add_bg"},created:function(){this.$route.query.code,this.dealCaptcha()}},a()(s,"beforeDestroy",function(){this.resend&&clearInterval(this.resend)}),a()(s,"watch",{count:function(){this.count>0?(this.captcha=this.count+"秒后重发",this.isWait=!0):(this.isWait=!1,this.captcha="获取验证码")}}),s),u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"public-view"},[n("div",{staticClass:"login"},[t._m(0),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"infoBox"},[t._m(1),t._v(" "),n("div",{staticClass:"center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"infoBox"},[t._m(2),t._v(" "),n("div",{staticClass:"center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"right"},[n("span",{staticClass:"captchaStyle",class:{wait:t.isWait},on:{click:function(e){return t.getLoginCode()}}},[t._v(t._s(t.captcha))])])])]),t._v(" "),n("div",{staticClass:"loginBotton"},[n("span",{staticClass:"button",on:{click:function(e){return t.login()}}},[t._v("登陆")])]),t._v(" "),n("div",{staticClass:"separator"},[t._v("其他登录方式")]),t._v(" "),n("div",{staticClass:"otherLogin"},[n("div",{staticClass:"wc"},[n("img",{attrs:{src:"static/images/Group 4@2x.png",alt:""},on:{click:function(e){return t.wxLogin()}}}),t._v(" "),n("div",{staticClass:"cont"},[t._v("微信登陆")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"userImg"},[e("img",{attrs:{src:"static/images/Group 2@2x.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left"},[e("span",[this._v("手机")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left"},[e("span",[this._v("验证码")])])}]};var d=n("C7Lr")(r,u,!1,function(t){n("pyVf")},"data-v-30083afa",null);e.default=d.exports},pyVf:function(t,e){}});